import pandas as pd
from nsepy import get_history
from datetime import date, datetime
stocks = ['3MINDIA',
'ABB',
'ACC',
'AIAENG',
'APLAPOLLO',
'AUBANK',
'AARTIDRUGS',
'AARTIIND',
'AAVAS',
'ABBOTINDIA',
'ADANIENT',
'ADANIGREEN',
'ADANIPORTS',
'ATGL',
'ADANITRANS',
'ABCAPITAL',
'ABFRL',
'ADVENZYMES',
'AEGISCHEM',
'AFFLE',
'AJANTPHARM',
'ALEMBICLTD',
'APLLTD',
'ALKEM',
'ALKYLAMINE',
'ALOKINDS',
'AMARAJABAT',
'AMBER',
'AMBUJACEM',
'ANGELONE',
'ANURAS',
'APOLLOHOSP',
'APOLLOTYRE',
'ASAHIINDIA',
'ASHOKLEY',
'ASHOKA',
'ASIANPAINT',
'ASTERDM',
'ASTRAZEN',
'ASTRAL',
'ATUL',
'AUROPHARMA',
'AVANTIFEED',
'DMART',
'AXISBANK',
'BASF',
'BEML',
'BSE',
'BAJAJ-AUTO',
'BAJAJCON',
'BAJAJELEC',
'BAJFINANCE',
'BAJAJFINSV',
'BAJAJHLDNG',
'BALAMINES',
'BALKRISIND',
'BALRAMCHIN',
'BANDHANBNK',
'BANKBARODA',
'BANKINDIA',
'MAHABANK',
'BATAINDIA',
'BAYERCROP',
'BERGEPAINT',
'BDL',
'BEL',
'BHARATFORG',
'BHEL',
'BPCL',
'BHARATRAS',
'BHARTIARTL',
'BIOCON',
'BIRLACORPN',
'BSOFT',
'BLUEDART',
'BLUESTARCO',
'BBTC',
'BOSCHLTD',
'BRIGADE',
'BRITANNIA',
'BURGERKING',
'CCL',
'CESC',
'CGPOWER',
'CRISIL',
'CSBBANK',
'CADILAHC',
'CANFINHOME',
'CANBK',
'CAPLIPOINT',
'CGCL',
'CARBORUNIV',
'CASTROLIND',
'CEATLTD',
'CENTRALBK',
'CDSL',
'CENTURYPLY',
'CENTURYTEX',
'CERA',
'CHALET',
'CHAMBLFERT',
'CHOLAHLDNG',
'CHOLAFIN',
'CIPLA',
'CUB',
'COALINDIA',
'COCHINSHIP',
'COFORGE',
'COLPAL',
'CAMS',
'CONCOR',
'COROMANDEL',
'CREDITACC',
'CROMPTON',
'CUMMINSIND',
'CYIENT',
'DCBBANK',
'DCMSHRIRAM',
'DLF',
'DABUR',
'DALBHARAT',
'DEEPAKNTR',
'DELTACORP',
'DHANI',
'DHANUKA',
'DBL',
'DIVISLAB',
'DIXON',
'LALPATHLAB',
'DRREDDY',
'EIDPARRY',
'EIHOTEL',
'EPL',
'EDELWEISS',
'EICHERMOT',
'ELGIEQUIP',
'EMAMILTD',
'ENDURANCE',
'ENGINERSIN',
'EQUITAS',
'EQUITASBNK',
'ERIS',
'ESCORTS',
'EXIDEIND',
'FDC',
'FEDERALBNK',
'FACT',
'FINEORG',
'FINCABLES',
'FINPIPE',
'FSL',
'FORTIS',
'FRETAIL',
'GAIL',
'GMMPFAUDLR',
'GALAXYSURF',
'GARFIBRES',
'GICRE',
'GILLETTE',
'GLAND',
'GLAXO',
'GLENMARK',
'GODFRYPHLP',
'GODREJAGRO',
'GODREJCP',
'GODREJIND',
'GODREJPROP',
'GRANULES',
'GRAPHITE',
'GRASIM',
'GESHIP',
'GREAVESCOT',
'GRINDWELL',
'GUJALKALI',
'GAEL',
'FLUOROCHEM',
'GUJGASLTD',
'GNFC',
'GPPL',
'GSFC',
'GSPL',
'HEG',
'HCLTECH',
'HDFCAMC',
'HDFCBANK',
'HDFCLIFE',
'HFCL',
'HAPPSTMNDS',
'HATHWAY',
'HATSUN',
'HAVELLS',
'HEIDELBERG',
'HEMIPROP',
'HEROMOTOCO',
'HIKAL',
'HINDALCO',
'HGS',
'HAL',
'HINDCOPPER',
'HINDPETRO',
'HINDUNILVR',
'HINDZINC',
'POWERINDIA',
'HOMEFIRST',
'HONAUT',
'HUDCO',
'HDFC',
'ICICIBANK',
'ICICIGI',
'ICICIPRULI',
'ISEC',
'IDBI',
'IDFCFIRSTB',
'IDFC',
'IFBIND',
'IIFL',
'IIFLWAM',
'IOLCP',
'IRB',
'IRCON',
'ITC',
'ITI',
'INDIACEM',
'IBULHSGFIN',
'IBREALEST',
'INDIAMART',
'INDIANB',
'IEX',
'INDHOTEL',
'IOC',
'IOB',
'IRCTC',
'IRFC',
'INDIGOPNTS',
'ICIL',
'INDOCO',
'IGL',
'INDUSTOWER',
'INDUSINDBK',
'INFIBEAM',
'NAUKRI',
'INFY',
'INGERRAND',
'INOXLEISUR',
'INTELLECT',
'INDIGO',
'IPCALAB',
'JBCHEPHARM',
'JKCEMENT',
'JKLAKSHMI',
'JKPAPER',
'JKTYRE',
'JMFINANCIL',
'JSWENERGY',
'JSWSTEEL',
'JAMNAAUTO',
'JINDALSAW',
'JSLHISAR',
'JSL',
'JINDALSTEL',
'JCHAC',
'JUBLFOOD',
'JUBLINGREA',
'JUBLPHARMA',
'JUSTDIAL',
'JYOTHYLAB',
'KPRMILL',
'KEI',
'KNRCON',
'KPITTECH',
'KRBL',
'KSB',
'KAJARIACER',
'KALPATPOWR',
'KALYANKJIL',
'KANSAINER',
'KARURVYSYA',
'KSCL',
'KEC',
'KOTAKBANK',
'L&TFH',
'LTTS',
'LICHSGFIN',
'LAOPALA',
'LAXMIMACH',
'LTI',
'LT',
'LAURUSLABS',
'LXCHEM',
'LEMONTREE',
'LINDEINDIA',
'LUPIN',
'LUXIND',
'MMTC',
'MOIL',
'MRF',
'LODHA',
'MGL',
'M&MFIN',
'M&M',
'MAHINDCIE',
'MHRIL',
'MAHLOG',
'MANAPPURAM',
'MRPL',
'MARICO',
'MARUTI',
'MASTEK',
'MFSL',
'MAXHEALTH',
'MAZDOCK',
'METROPOLIS',
'MINDTREE',
'MINDACORP',
'MINDAIND',
'MIDHANI',
'MOTILALOFS',
'MPHASIS',
'MCX',
'MUTHOOTFIN',
'NATCOPHARM',
'NBCC',
'NCC',
'NESCO',
'NHPC',
'NLCINDIA',
'NMDC',
'NOCIL',
'NTPC',
'NH',
'NATIONALUM',
'NFL',
'NAVINFLUOR',
'NAZARA',
'NESTLEIND',
'NETWORK18',
'NILKAMAL',
'NAM-INDIA',
'OBEROIRLTY',
'ONGC',
'OIL',
'OFSS',
'ORIENTELEC',
'PCBL',
'PIIND',
'PNBHOUSING',
'PNCINFRA',
'PVR',
'PAGEIND',
'PERSISTENT',
'PETRONET',
'PFIZER',
'PHOENIXLTD',
'PIDILITIND',
'PEL',
'POLYMED',
'POLYCAB',
'POLYPLEX',
'POONAWALLA',
'PFC',
'POWERGRID',
'PRAJIND',
'PRESTIGE',
'PRINCEPIPE',
'PRSMJOHNSN',
'PGHL',
'PGHH',
'PNB',
'QUESS',
'RBLBANK',
'RECLTD',
'RHIM',
'RITES',
'RADICO',
'RVNL',
'RAILTEL',
'RAIN',
'RAJESHEXPO',
'RALLIS',
'RCF',
'RATNAMANI',
'REDINGTON',
'RELAXO',
'RELIANCE',
'ROSSARI',
'ROUTE',
'SBICARD',
'SBILIFE',
'SIS',
'SJVN',
'SKFINDIA',
'SRF',
'SANOFI',
'SCHAEFFLER',
'SCHNEIDER',
'SEQUENT',
'SHARDACROP',
'SFL',
'SHILPAMED',
'SCI',
'SHREECEM',
'SHRIRAMCIT',
'SRTRANSFIN',
'SIEMENS',
'SOBHA',
'SOLARINDS',
'SOLARA',
'SONACOMS',
'SONATSOFTW',
'SPANDANA',
'SPICEJET',
'STARCEMENT',
'SBIN',
'SAIL',
'SWSOLAR',
'STLTECH',
'STAR',
'SUDARSCHEM',
'SUMICHEM',
'SPARC',
'SUNPHARMA',
'SUNTV',
'SUNDARMFIN',
'SUNDRMFAST',
'SUNTECK',
'SUPRAJIT',
'SUPREMEIND',
'SUPPETRO',
'SUVENPHAR',
'SUZLON',
'SYMPHONY',
'SYNGENE',
'TCIEXP',
'TCNSBRANDS',
'TTKPRESTIG',
'TV18BRDCST',
'TVSMOTOR',
'TANLA',
'TASTYBITE',
'TATACHEM',
'TATACOFFEE',
'TATACOMM',
'TCS',
'TATACONSUM',
'TATAELXSI',
'TATAMTRDVR',
'TATAMOTORS',
'TATAPOWER',
'TATASTLLP',
'TATASTEEL',
'TTML',
'TEAMLEASE',
'TECHM',
'NIACL',
'RAMCOCEM',
'THERMAX',
'THYROCARE',
'TIMKEN',
'TITAN',
'TORNTPHARM',
'TORNTPOWER',
'TRENT',
'TRIDENT',
'TRITURBINE',
'TIINDIA',
'UCOBANK',
'UFLEX',
'UPL',
'UTIAMC',
'UJJIVAN',
'UJJIVANSFB',
'ULTRACEMCO',
'UNIONBANK',
'UBL',
'MCDOWELL-N',
'VGUARD',
'VMART',
'VIPIND',
'VAIBHAVGBL',
'VAKRANGEE',
'VALIANTORG',
'VTL',
'VARROC',
'VBL',
'VEDL',
'VENKEYS',
'VINATIORGA',
'IDEA',
'VOLTAS',
'WABCOINDIA',
'WELCORP',
'WELSPUNIND',
'WESTLIFE',
'WHIRLPOOL',
'WIPRO',
'WOCKPHARMA',
'YESBANK',
'ZEEL',
'ZENSARTECH',
'ZYDUSWELL',
'ECLERX',]
start = date(2022,1,15)
end = date.today()

def importData():
    for stock in stocks:
        rawdata = get_history(symbol=stock,start = start,end = end)
        file_name = 'data/{}.csv'.format(stock)
        df = pd.DataFrame(rawdata)
        df.to_csv(file_name,encoding='utf-8')
        print(stock)

# def loadData():
#     for stock in stocks:
#         try:
#             rawdata  =  pd.read_csv('data/{}.csv'.format(stock))
#             print(stock)
#             print(rawdata)
#         except:
            # pass    



importData()




